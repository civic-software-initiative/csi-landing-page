<div class="toast-center toast toast-top z-40 whitespace-nowrap">
  <div id="errorToast" class="alert alert-error hidden">
    <span>Failed to submit form</span>
  </div>
  <div id="successToast" class="alert alert-success hidden">
    <span>Form submitted</span>
  </div>
</div>

<div class="flex items-center justify-center bg-primary">
  <div class="flex max-w-7xl flex-col md:flex-row">
    <div class="bg-primary px-12 py-8 md:w-1/2">
      <h2 class="pb-2 text-3xl font-bold text-base-100">Contact us</h2>
      <p class="text-lg text-base-100">
        Let us know how we can partner with you, whether you're a client, a new
        recruit, or a collaborating partner organization. We're excited to hear
        from you!
      </p>
    </div>
    <div
      class="flex-grow bg-base-100 px-12 py-4 lg:rounded-xl lg:border-8 lg:border-primary"
    >
      <form id="contactForm" class="my-4 flex flex-col gap-4">
        <div class="form-group">
          <input
            type="text"
            class="text-m form-control w-full rounded border border-solid border-gray-300 bg-white px-2 transition ease-in-out focus:border-secondary focus:bg-accent focus:text-gray-700 focus:outline-none"
            id="nameInput"
            placeholder="Name"
            required
          />
        </div>
        <div class="form-group">
          <input
            type="email"
            class="text-m form-control w-full rounded border border-solid border-gray-300 bg-white px-2 transition ease-in-out focus:border-secondary focus:bg-accent focus:text-gray-700 focus:outline-none"
            id="emailInput"
            placeholder="Email address"
            required
          />
        </div>
        <div class="form-group">
          <textarea
            class="text-m form-control w-full rounded border border-solid border-gray-300 bg-white px-2 transition ease-in-out focus:border-secondary focus:bg-accent focus:text-gray-700 focus:outline-none"
            id="bodyInput"
            rows="6"
            placeholder="Message"></textarea>
        </div>

        <button
          type="submit"
          id="contactUsButton"
          class="btn-primary btn w-full text-lg normal-case text-base-100 hover:text-accent"
          >Send</button
        >
      </form>
    </div>
  </div>
</div>

<script is:inline>
  document
    .getElementById("contactForm")
    .addEventListener("submit", async (event) => {
      event.preventDefault();
      const submitButton = document.getElementById("contactUsButton");
      submitButton.setAttribute("disabled", "disabled");

      const name = document.getElementById("nameInput").value.trim();
      const email = document.getElementById("emailInput").value.trim();
      const message = document.getElementById("bodyInput").value.trim();

      const handleError = (_error) => {
        document.getElementById("errorToast").classList.remove("hidden");
        setTimeout(() => {
          document.getElementById("errorToast").classList.add("hidden");
        }, 5000);
      };

      try {
        const response = await fetch(
          "https://nr9159tsv6.execute-api.us-east-1.amazonaws.com/contact-us",
          {
            method: "POST",
            body: JSON.stringify({ name, email, message }),
            headers: {
              "Content-Type": "application/json",
            },
          }
        );
        if (response.ok) {
          document.getElementById("nameInput").value = "";
          document.getElementById("emailInput").value = "";
          document.getElementById("bodyInput").value = "";
          document.getElementById("successToast").classList.remove("hidden");
          setTimeout(() => {
            document.getElementById("successToast").classList.add("hidden");
          }, 5000);
        } else {
          handleError(response.status);
        }
      } catch (error) {
        handleError(error);
      }

      document.getElementById("contactUsButton").removeAttribute("disabled");
    });
</script>
